# COMPLETE PACKAGE - THREE FILES

## What's In This Package

This ZIP contains everything you need for your netlify/functions/ folder:

1. **extract-gpc-data.mjs** - Extracts ALL defendants from GPCs
2. **generate-affidavit.mjs** - Creates blank affidavits (UPDATED to work with your template structure)
3. **Form_11_-_Affidavit_of_Service.docx** - Your template (the one you just uploaded)

## What To Do

### Step 1: Delete Everything in netlify/functions/

You said you already emptied this folder - good!

If not:
1. Go to: `Documents/batch_affidavit_web/netlify/functions/`
2. Delete all files in there

### Step 2: Add These Three Files

1. Extract this ZIP
2. Copy ALL THREE files from the extracted folder
3. Paste into: `Documents/batch_affidavit_web/netlify/functions/`

You should now have exactly 3 files in netlify/functions/:
- extract-gpc-data.mjs
- generate-affidavit.mjs
- Form_11_-_Affidavit_of_Service.docx

### Step 3: Commit and Push

1. Open GitHub Desktop
2. You should see "3 changed files" or "3 added files"
3. Summary: "Complete system with working template"
4. Click "Commit to main"
5. Click "Push origin"
6. Wait 2-3 minutes

### Step 4: Test

1. Go to your site: https://prismatic-blini-1e4812.netlify.app
2. Upload the IMMACULATE HEART COLLEGE GPC
3. Click "Process & Generate Affidavits"
4. You should see: "2 defendants found"
5. Download links should appear for 2 affidavits
6. Download them and open in Word
7. Check that:
   - Case number is filled in: GCLM/2763/2024
   - Claimant is filled in: IMMACULATE HEART COLLEGE
   - Defendant is filled in: Mark EVANS (or Lauren CUNNINGHAM)
   - Date, Time, Place are BLANK

## How This Works Differently

The NEW generate-affidavit.mjs works with YOUR template structure:

**Your template has:**
- Bracket fields: [Date], [time am/pm], [Place], [Name], [Name of process]
- Empty table cells where: Case number, Claimant, Defendant should go

**The new code:**
1. Uses docxtemplater to fill bracket fields (leaving Date/Time/Place blank)
2. Manually inserts Case number, Claimant, Defendant into the correct table cells
3. This matches how your Python system worked!

## If It Still Doesn't Work

1. Press F12 on the website
2. Click Console tab
3. Screenshot any red errors
4. Show me the errors

But it SHOULD work now - this code is designed specifically for your template structure!

## Summary

- 3 files go in netlify/functions/
- Commit and push
- Wait 2-3 minutes
- Test with your GPC
- Should get 2 blank affidavits ready for manual service details

Good luck!
